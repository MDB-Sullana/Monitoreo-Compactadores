<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Monitoreo Ciudadano - Bellavista</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fuente -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background: #f3f4f6; }
        #content-frame { height: calc(100vh - 120px); }
    </style>
</head>

<body class="min-h-screen flex flex-col">

    <!-- HEADER -->
    <header class="bg-blue-900 shadow-lg p-4 sticky top-0 z-10">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <img 
  src="./logo-bellavista.jpeg" 
  alt="Logo Bellavista"
  class="h-12 w-12 rounded-full object-cover shadow-md"
  onerror="this.src='https://placehold.co/60x60/1e3a8a/ffffff?text=LOGO'"
>
                <h1 class="text-xl md:text-2xl font-bold text-white">
                    MONITOREO CIUDADANO DE CAMIONES COMPACTADORES
                </h1>
            </div>

            <span class="hidden sm:block bg-yellow-400 text-gray-900 text-sm font-semibold px-3 py-1 rounded-full shadow-inner">
                <span class="animate-pulse inline-block w-2 h-2 mr-1 bg-green-500 rounded-full"></span>
                En LÃ­nea
            </span>
        </div>
    </header>

    <!-- CONTENIDO -->
    <main class="flex-grow p-4 md:p-6">
        <div class="max-w-full mx-auto bg-white rounded-xl shadow-2xl overflow-hidden">
            <iframe id="content-frame"
                    src="https://monitoreo.gpseyes.pe/sharing/f26738032cc992ea790a7a6d80f5b066"
                    class="w-full"
                    frameborder="0"
                    allowfullscreen>
            </iframe>
        </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-100 border-t border-gray-200 p-3 text-center text-sm text-gray-600">
        Â© 2024 Monitoreo Ciudadano - Municipalidad Distrital de Bellavista.
    </footer>

    <!-- CHATBOT -->
    <div id="chatbot-container"
         class="fixed bottom-4 right-4 z-50 flex flex-col items-end">
    <!-- BOTÃ“N FLOTANTE DEL CHATBOT -->
    <style>
  #chatbot-button {
    position: fixed;
    bottom: 25px;
    right: 25px;
    background: #1e3a8a;
    color: white;
    width: 65px;
    height: 65px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,0,0,0.3);
    z-index: 9999;
  }

  #chatbot-window {
    width: 330px;
    height: 430px;
    background: #ffffff;
    position: fixed;
    bottom: 100px;
    right: 25px;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.25);
    display: none;
    flex-direction: column;
    overflow: hidden;
    z-index: 9999;
  }

  #chatbot-header {
    background: #1e3a8a;
    color: white;
    padding: 12px;
    font-weight: bold;
    text-align: center;
  }

  #chatbot-messages {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
  }

  .msg {
    margin-bottom: 12px;
    padding: 8px 12px;
    max-width: 80%;
    border-radius: 12px;
    font-size: 14px;
  }

  .bot {
    background: #e5e7eb;
    color: #111827;
  }

  .user {
    background: #1e3a8a;
    color: white;
    margin-left: auto;
  }

  #chatbot-input-area {
    display: flex;
    padding: 8px;
    background: #f3f4f6;
  }

  #chatbot-input {
    flex: 1;
    padding: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }

  #send-btn {
    margin-left: 8px;
    background: #1e3a8a;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
  }
</style>

<div id="chatbot-button">ðŸ’¬</div>

<div id="chatbot-window">
  <div id="chatbot-header">Asistente Virtual Bellavista</div>
  <div id="chatbot-messages"></div>
  <div id="chatbot-input-area">
    <input id="chatbot-input" type="text" placeholder="Escribe un mensaje...">
    <div id="send-btn">Enviar</div>
  </div>
</div>

        <!-- SCRIPT CHATBOT -->
    <script>
const apiKey = "TU_API_KEY_AQUI";

document.getElementById("chatbot-button").onclick = function () {
  const win = document.getElementById("chatbot-window");
  win.style.display = win.style.display === "flex" ? "none" : "flex";
};

async function sendMessage() {
  const input = document.getElementById("chatbot-input");
  const msg = input.value.trim();
  if (!msg) return;

  addMessage(msg, "user");
  input.value = "";

  addMessage("Escribiendo...", "bot", true);

  const response = await fetch("https://api.openai.com/v1/responses", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + apiKey
    },
    body: JSON.stringify({
      model: "gpt-4.1-mini",  
      input: msg
    })
  });

  const data = await response.json();
  removeTyping();
  addMessage(data.output_text, "bot");
}

function addMessage(text, type, typing = false) {
  const messages = document.getElementById("chatbot-messages");
  const messageDiv = document.createElement("div");
  messageDiv.className = "msg " + type;

  if (typing) {
    messageDiv.id = "typing-msg";
  }

  messageDiv.innerText = text;
  messages.appendChild(messageDiv);
  messages.scrollTop = messages.scrollHeight;
}

function removeTyping() {
  const typingMsg = document.getElementById("typing-msg");
  if (typingMsg) typingMsg.remove();
}

document.getElementById("send-btn").onclick = sendMessage;

document.getElementById("chatbot-input").addEventListener("keypress", e => {
  if (e.key === "Enter") sendMessage();
});
</script>


</body>
</html>
